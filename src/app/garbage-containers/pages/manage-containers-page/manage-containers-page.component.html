<p-panel styleClass="flex flex-column gap-5" [style]="{ height: '80vh' }">
    <ng-template #header>
        <div class="flex flex-row justify-content-between align-items-between w-full">
            <span class="font-bold"> Contenedores </span>

            <p-button 
                icon="pi pi-arrow-left"
                label="Regresar"
                severity="info"
                (click)="onReturnPage()"
            ></p-button>
        </div>
    </ng-template>
    
    <p-card>
        <p-table
            #dt1
            [tableStyle]="{'text-align': 'center', 'overflow-x': 'auto'}"
            [value]="response"
            [rows]="10"
            [rowsPerPageOptions]="[10, 20, 50]"
            [paginator]="true"
            [globalFilterFields]="['status']"
        >
    
            <ng-template #caption>
                <div class="flex">
                    <p-iconfield iconPosition="right">
                        <p-inputicon>
                            <i class="pi pi-search"></i>
                        </p-inputicon>
                        <input
                            #globalFilter
                            pInputText 
                            type="text"
                            placeholder="Buscar contenedor..."
                            style="width: 100%;"
                            (input)="dt1.filterGlobal(globalFilter.value, 'contains')"
                        />
    
                    </p-iconfield>
    
                    <p-iconfield iconPosition="left" class="ml-auto">
                        <p-button
                            (click)="openCreateContainerModal()"
                        >
                            Agregar
                            <i class="pi pi-plus"></i>
                        </p-button>
                    </p-iconfield>
                </div>
            </ng-template>
            <ng-template #header>
                <tr>
                    <th>Contenedor</th>
                    <th>Latitud</th>
                    <th>Longitud</th>
                    <th>Capacidad</th>
                    <th>Estado de Llenado</th>
                    <th>Fecha de actualizaci√≥n</th>
                    <th>Acciones</th>
                </tr>
            </ng-template>
            <ng-template #body let-container let-rowIndex="rowIndex">
                @if (loading()) {
                    <tr>
                        @for (_ of [1,2,3,4,5,6,7]; track $index) {

                            <td><p-skeleton></p-skeleton></td>
                        }
                    </tr>
                } @else if (containers_response.length > 0) {
                    <tr [pSelectableRow]="container">
                        <td> {{ rowIndex + 1 }} </td>
                        <td> {{ container.location.latitude }} </td>
                        <td> {{ container.location.longitude }} </td>
                        <td> {{ container.capacity_liters }} </td>
                        <td> 
                            <p-button
                                [severity]="container.status === 'high' ? 'danger' : container.status === 'medium' ? 'warn' : 'success'"
                                [label]="container.status"
                                
                                iconPos="left"
                                styleClass="p-button-text"
                                class="w-full"
                                [disabled]="true"
                            >
                                <i class="pi" 
                                    [ngClass]="{'pi-ban': container.status === 'high', 
                                                'pi-exclamation-triangle': container.status === 'medium', 
                                                'pi-check': container.status === 'low'}">
                                </i>
                            </p-button>
                        </td>
                        <td> {{ container.last_updated | date }} </td>
                        <td>
                            <div class="flex justify-content-center align-items-center gap-2">
                                <p-button
                                    (click)="onOpenEditModal(container.id)"
                                    severity="warn"
                                    pTooltip="Editar Contenedor"
                                    tooltipPosition="top"
                                >
                                    <i class="pi pi-pencil"></i>
                                </p-button>
        
                                <p-button
                                    (click)="deleteContainer(container?.id)"
                                    severity="danger"
                                    pTooltip="Eliminar Contenedor"
                                    tooltipPosition="top"
                                >
                                    <i  class="pi pi-times"></i>
                                </p-button>
                            </div>
                        </td>
                    </tr>
                } @else {
                    <tr>
                        <td colspan="7">No se encontraron Contenedores</td>
                    </tr>
                }
            </ng-template>
        </p-table>
    </p-card>

  
</p-panel>
